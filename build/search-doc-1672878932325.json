[{"title":"Azure Permission & Resource Management","type":0,"sectionRef":"#","url":"/blog/Azure Permission & Resource Management","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. The 4 management levels​","type":1,"pageTitle":"Azure Permission & Resource Management","url":"/blog/Azure Permission & Resource Management#1-the-4-management-levels","content":"The below is nothing original by the way, I've lifted it and re-written the concepts into another format from a Microsoft docs article here, you may prefer their version. Organize your Azure resources effectively Management groups help to manage access via policy and compliance over multiple subscriptions. When a subscription is part of a management group, it'll automatically inherit all conditionas\\settings setup in the management group. Subscriptions logically associate permissions with resources they create. Each individual subscription has limits\\quotas regarding the amount of resources it can create\\use. Subscriptions also help to organise costs. Resource Groups are logical containers, where you can deploy Azure resources to; you could think of them being along the lines of Folders. You can also apply tags to help better manage resources and what they're for. Resources are instances of services that you can create. "},{"title":"2. Managing Access to resources​","type":1,"pageTitle":"Azure Permission & Resource Management","url":"/blog/Azure Permission & Resource Management#2-managing-access-to-resources","content":"We should always plan for the least privileges required to allow a team to work, the permission model in Azure is designed to allow this however, I'd say it is so granular that it generates more work that necessary in most cases. Here's a basic list from my experience setting up a permission model in the past; it covers a service desk team. Call Agent team - No access to Azure resources.Level 1, 2 and 3 teams - Reader access at the Subscription level, providing Contributor role at the Resource Group or Resource level where appropriate.Infrastructure - If the team also performs security functions, I would suggest the Contributor role be assigned of at the Subscription Level where appropriate and to assign the Owner role at the resource group level where the Infrastructure they &quot;own&quot; is situated. Permission elevation controls and experience levels should be taken into account. In previous companies, I'd trust the L2 team to have the same access as L3 and, in some cases I'd not even consider it! You can also control Service Desk team access using Change Control. Asking them to justify their access requirements via a change process not only allows others to check what they're doing, it could also show that they do not need to access rights in the first place. Speaking from experience, I'd highly recommend trusting your Infrastructure team to have the Contributor role at the Subscription level where possible. It will make a lot of difference to all teams &quot;quality of life&quot; if they've access to someone who can carry out actions they cannot. "},{"title":"3. Resource tagging​","type":1,"pageTitle":"Azure Permission & Resource Management","url":"/blog/Azure Permission & Resource Management#3-resource-tagging","content":"Tags can be an absolute godsent and can help you to quickly identify your resources and resource groups. You apply tags to your Azure resources and resource groups to logically organize them into categories. Tags can include context about the resource's associated workload or application, operational requirements, and ownership information. Some suggested uses for tags;Metadata and documentation, Admins can apply a tag to all resources matching a specific workload or project.Automation, you can target a tag for scripts etc.Cost analysis, this is the most common use case that I've come across for tags. Each resource or resource group can have a maximum of 50 tag name and value pairs. This limitation only applies to tags directly applied to the resource group or resource. That turned out to be a little longer than I'd hoped for, with any luck it'll be of some use. "},{"title":"Command Cheat sheet","type":0,"sectionRef":"#","url":"/docs/Azure CLi/Command Cheat sheet","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"Connection​","type":1,"pageTitle":"Command Cheat sheet","url":"/docs/Azure CLi/Command Cheat sheet#connection","content":""},{"title":"Login​","type":1,"pageTitle":"Command Cheat sheet","url":"/docs/Azure CLi/Command Cheat sheet#login","content":"Login to Azure tenant, az login, this uses the web browser to authenticate. "},{"title":"Set context​","type":1,"pageTitle":"Command Cheat sheet","url":"/docs/Azure CLi/Command Cheat sheet#set-context","content":"Once logged in, set the context you want to work in (Subscription). List all subscription, az account list. Set the context using the subscript ID az account set --subscription &lt;subscription ID&gt;. "},{"title":"Management​","type":1,"pageTitle":"Command Cheat sheet","url":"/docs/Azure CLi/Command Cheat sheet#management","content":""},{"title":"List Resource Groups​","type":1,"pageTitle":"Command Cheat sheet","url":"/docs/Azure CLi/Command Cheat sheet#list-resource-groups","content":"List resource groups as a table, az group list --output table. "},{"title":"Create resource​","type":1,"pageTitle":"Command Cheat sheet","url":"/docs/Azure CLi/Command Cheat sheet#create-resource","content":""},{"title":"Resourse Group​","type":1,"pageTitle":"Command Cheat sheet","url":"/docs/Azure CLi/Command Cheat sheet#resourse-group","content":"Create a resource group, with a name and location, az group create --name exampleRG --location eastus. "},{"title":"Deployment​","type":1,"pageTitle":"Command Cheat sheet","url":"/docs/Azure CLi/Command Cheat sheet#deployment","content":"Check deployments​ az deployment list --output table Storage account​ Create the resource group before deployment of the below command. az deployment group create --resource-group exampleRG --template-file main.bicep --parameters storageName=uniquename "},{"title":"Delete Resources​","type":1,"pageTitle":"Command Cheat sheet","url":"/docs/Azure CLi/Command Cheat sheet#delete-resources","content":""},{"title":"Resourse Group​","type":1,"pageTitle":"Command Cheat sheet","url":"/docs/Azure CLi/Command Cheat sheet#resourse-group-1","content":"az group delete --resource-group &lt;group name&gt; "},{"title":"Automation Account Setup Cheatsheet","type":0,"sectionRef":"#","url":"/docs/Azure Resources Management/Automation Account Setup Cheatsheet","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. Creating the Automation Account​","type":1,"pageTitle":"Automation Account Setup Cheatsheet","url":"/docs/Azure Resources Management/Automation Account Setup Cheatsheet#1-creating-the-automation-account","content":""},{"title":"1.1. Considerations​","type":1,"pageTitle":"Automation Account Setup Cheatsheet","url":"/docs/Azure Resources Management/Automation Account Setup Cheatsheet#11-considerations","content":"Naming convention.Purpose of the Automation Account.Will it need a Managed identity? Naming conventions matter in Azure because you cannot change the name after the resource has been created, suggsted naming convention would be aa-&lt;company name&gt;-&lt;region&gt;-&lt;workload type&gt;-&lt;resource&gt;-&lt;number&gt;, this would translate to aa-wh-uks-prod-automationacc-001. The same can be said of the Resource Group, a suggested name could be rg-wh-uks-prod-Automation-001. Purpose of the resource is also important, are you going to use the resource for patch management, is it being specifically used for a particalar solution or workload? Importantly, will it be created and possibly deleted along with other resources; in which case it can live in the same resource group as those resources. A Managed identity will be needed should the Automation Account need to authenticate to carry out any tasks. It will also be tied to the lifecycle of the Automation account. "},{"title":"1.2. Creation steps​","type":1,"pageTitle":"Automation Account Setup Cheatsheet","url":"/docs/Azure Resources Management/Automation Account Setup Cheatsheet#12-creation-steps","content":"Microsoft doc - Create a new Automation account in the Azure portal. 1.2.1. Using a system-assigned managed identity​ Microsoft doc - Using a system-assigned managed identity for an Azure Automation account. "},{"title":"2. Notes​","type":1,"pageTitle":"Automation Account Setup Cheatsheet","url":"/docs/Azure Resources Management/Automation Account Setup Cheatsheet#2-notes","content":""},{"title":"2.1. Managed Identity​","type":1,"pageTitle":"Automation Account Setup Cheatsheet","url":"/docs/Azure Resources Management/Automation Account Setup Cheatsheet#21-managed-identity","content":"You'll find the managed Identity itself under Enterprise App Registrations.You cannot assign Azure AD or Microsoft Graph roles to the System Managed Identity through the GUI, you must do this from command line. See here for more info. "},{"title":"Resizing a Virtual Machine","type":0,"sectionRef":"#","url":"/docs/Azure Resources Management/Resizing a Virtual Machine","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. Before you begin​","type":1,"pageTitle":"Resizing a Virtual Machine","url":"/docs/Azure Resources Management/Resizing a Virtual Machine#1-before-you-begin","content":"Shutdown the VM from within it's OS if possible (Not always necessary at all but, nice to do).If you cannot see the VM size that you're looking for it may not be compatible with your VM. You can have too many disk or NICs attached to the VM for the size you want. The typ of disks that you have attached can limit your options, premium and standard tier. "},{"title":"2. Re-siging the vm​","type":1,"pageTitle":"Resizing a Virtual Machine","url":"/docs/Azure Resources Management/Resizing a Virtual Machine#2-re-siging-the-vm","content":"Open the Azure portal. Open the page for the virtual machine.  In the left menu, select Size. Note: De-allocating the VM also releases any dynamic IP addresses assigned to the VM. The OS and data disks are not affected. If you are resizing a production VM, consider using Azure Capacity Reservations to reserve Compute capacity in the region.  Pick a new size from the list of available sizes and then select Resize. "},{"title":"Assign Managed Identity permissions via CMDLine","type":0,"sectionRef":"#","url":"/docs/Azure Resources Management/Assign Managed Identity permissions via CMDLine","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. The command​","type":1,"pageTitle":"Assign Managed Identity permissions via CMDLine","url":"/docs/Azure Resources Management/Assign Managed Identity permissions via CMDLine#1-the-command","content":" # Your tenant id. $TenantID=&quot;Add your tenant ID&quot; # Microsoft Graph App ID (DON'T CHANGE). $GraphAppId = &quot;00000003-0000-0000-c000-000000000000&quot; # Name of the manage identity (same as the Logic App name). $DisplayNameOfMSI=&quot;Add display name of Enterprise App&quot; # Check the Microsoft Graph documentation for the permission you need for the operation. $PermissionName = &quot;Add your permission here&quot; # Install the module (You need admin on the machine) Install-Module AzureAD # Connect to Azure AD via tenant ID, you'll need an admin account to login with though. Connect-AzureAD -TenantId $TenantID # Collects the Target System Managed Identities information into the MSI variable. $MSI = (Get-AzureADServicePrincipal -Filter &quot;displayName eq '$DisplayNameOfMSI'&quot;) Start-Sleep -Seconds 10 # Store the Microsoft Graph API informaiton into the GraphServicePrincipal variable. $GraphServicePrincipal = Get-AzureADServicePrincipal -Filter &quot;appId eq '$GraphAppId'&quot; # Searches Microsoft Graph API for the value matching the PermissionName variable populated above and stores this in the AppRole Variable. $AppRole = $GraphServicePrincipal.AppRoles | Where-Object {$_.Value -eq $PermissionName -and $_.AllowedMemberTypes -contains &quot;Application&quot;} # Assigned the permission from the Microsoft Graph API to the target Managed Identity. New-AzureADServiceAppRoleAssignment -ObjectId $MSI.ObjectId -ResourceId $GraphServicePrincipal.ObjectId -Id $appRole.Id -PrincipalId $MSI.ObjectId  Annotated the hell out of it as the command really confused me. "},{"title":"2. Notes​","type":1,"pageTitle":"Assign Managed Identity permissions via CMDLine","url":"/docs/Azure Resources Management/Assign Managed Identity permissions via CMDLine#2-notes","content":"It takes a few minutes for this change to show in the GUI.If the permission already exists the promtp will error on the final command. "},{"title":"Azure SQL Server setup cheatsheet","type":0,"sectionRef":"#","url":"/docs/Azure Resources Management/Azure SQL Server setup cheatsheet","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. Before you begin​","type":1,"pageTitle":"Azure SQL Server setup cheatsheet","url":"/docs/Azure Resources Management/Azure SQL Server setup cheatsheet#1-before-you-begin","content":"If the customer does not specify, work with them to ascertain best size\\shape of VM.If required run through the cost and dependancies on the build.Estimate build time and get approval to create the resources.Build the resources.Create Subscription.Created Resources Group.Create Instance.Setup Monitoring and Alerts.Setup backups if needed.Enable any security features required.Testing.Pass back to customer. "},{"title":"2. Suggested pre-requisit information gathering​","type":1,"pageTitle":"Azure SQL Server setup cheatsheet","url":"/docs/Azure Resources Management/Azure SQL Server setup cheatsheet#2-suggested-pre-requisit-information-gathering","content":"If the customer does not know the answer the questions below, we should define as much as possible to make our lives easier. Intended workload, could the instance be reduced to a PaaS offering, to reduce managemnt and cost overheads.Chose the shape and size of instance, if it must stay as a IaaS offering, you can build full SQL server instance on a Windows VM, this will be the most costly. There isAzure SQL server as a PaaS offering though and and intermediary option too.Networking, does a new vNet need creating or will it be added to a current one.Resiliancy of the instance, does it need to be replecatied across DCs or Regions?Backups, any specific needs for backups.Cost, is this authorised already or do you need to provide some cost estimations, Azure Pricing calculator is here. Advise the customer that additional shape and size changes may incurr costs down the line. Suggest reservations if the workload is not to change.Subscription, where resources will be placed or, will a new one need to be created.Resource Group, is there one to be created or does one exist. Resources should be grouped together by life cycle.Tags, tags are useful for billing, reporting and segregating resources. Suggested naming conventions here. "},{"title":"3. Recommendations for building the instance​","type":1,"pageTitle":"Azure SQL Server setup cheatsheet","url":"/docs/Azure Resources Management/Azure SQL Server setup cheatsheet#3-recommendations-for-building-the-instance","content":""},{"title":"3.1. Subscription​","type":1,"pageTitle":"Azure SQL Server setup cheatsheet","url":"/docs/Azure Resources Management/Azure SQL Server setup cheatsheet#31-subscription","content":"Name this appropriately based on it's purpose. If it hosts production resources, name it Prodiction.If it hosts developement resources, name it Developement.If it hosts resources for a particular application or solution, name it after that app or solution. "},{"title":"3.2. Resource Group​","type":1,"pageTitle":"Azure SQL Server setup cheatsheet","url":"/docs/Azure Resources Management/Azure SQL Server setup cheatsheet#32-resource-group","content":"Resource Groups are logical containers that group resources together.Resources within Resource Groups should share the same product life cycle.Many resources cannot be moved between groups after they've been created. Naming a RG is permenant and cannot be amended after the fact, base the name on what it is hosting, I suggest added something for the location of the RG as well. Examplesbelow: &quot;Company&quot;-&quot;environment type&quot;-&quot;Region&quot;-&quot;Resource information&quot;. Note that Resource Groups and subscriptions can have upper and lower case, instances\\apps are all lower-case only. "},{"title":"3.3. SQL Server Creation​","type":1,"pageTitle":"Azure SQL Server setup cheatsheet","url":"/docs/Azure Resources Management/Azure SQL Server setup cheatsheet#33-sql-server-creation","content":"3.3.1. Basics​ Subscription to host resources.Resource Group name.Resource Name.Region (Location).Authentication method. Where apprproate, use both SQL and Azure AD, that covers both sides unless the user specifies otherwise. 3.3.2. Networking​ Allow Azure services and resources to acces this server. The defaul rule will allow Azure resources from the customer tenant and all other Azure tenants to reach this resource. "},{"title":"3.4. Azure SQL Database Creation​","type":1,"pageTitle":"Azure SQL Server setup cheatsheet","url":"/docs/Azure Resources Management/Azure SQL Server setup cheatsheet#34-azure-sql-database-creation","content":"This resource sits within the Azure SQL Server above in some cases, if this is asked for, you do not need to answer the above questions 1-4 again. If the customer does not know, we should define where this sits. By Microsoft recomendation, resrouces should sit in a resource group together than share the same life cycle. Names must be in lowercase, Azure does not support uppercase names. "},{"title":"4. Monitoring​","type":1,"pageTitle":"Azure SQL Server setup cheatsheet","url":"/docs/Azure Resources Management/Azure SQL Server setup cheatsheet#4-monitoring","content":"This area needs updating. "},{"title":"Azure Backup Setup CheatSheet","type":0,"sectionRef":"#","url":"/docs/Azure Resources Management/Azure Backup Setup CheatSheet","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1.1. Create the below resources in the FW-Azure Production subscription​","type":1,"pageTitle":"Azure Backup Setup CheatSheet","url":"/docs/Azure Resources Management/Azure Backup Setup CheatSheet#11-create-the-below-resources-in-the-fw-azure-production-subscription","content":"Create the resource group, example, rg-&lt;customername&gt;-&lt;region&gt;-&lt;prod/dev&gt;-backups-01.Create a recovery services vault to store the backups (GRS is the preferred option, LRS for lowest cost), example, rsv-&lt;customername&gt;-&lt;region&gt;-&lt;prod/dev&gt;-backup-01.Create a log analytics workspace or reuse another one, example, la-&lt;customername&gt;-&lt;region&gt;-&lt;prod/dev&gt;-backup-01. "},{"title":"1.2. Configure Backup Policy​","type":1,"pageTitle":"Azure Backup Setup CheatSheet","url":"/docs/Azure Resources Management/Azure Backup Setup CheatSheet#12-configure-backup-policy","content":"Configure the backup policy in-line with the SC team standard being used for other customers, this has been provided to me. Suggested Name format: Bkup-policy-&lt;time of day&gt;-&lt;policy type&gt;.Example name: bkup-policy-nightly-std.  "},{"title":"1.3. Configure Alerting​","type":1,"pageTitle":"Azure Backup Setup CheatSheet","url":"/docs/Azure Resources Management/Azure Backup Setup CheatSheet#13-configure-alerting","content":"Note that this method is using the old backup alerting method, this is being replaced by Azure Monitor. Microsoft Link for more information Configure diagnostic logs to be sent from Azure Backup to the Log Anlytics workspace above. From the Recovery services vault just setup. Click on Backup Alerts, under the Monitoring section.Click Configure Notifications. Enable Notifications: YesRecipients(Email): monitoring@DomainName.comNotify: Hourly digestSeverity: Critical &amp; Warning "},{"title":"1.3.1. Example notifiation config​","type":1,"pageTitle":"Azure Backup Setup CheatSheet","url":"/docs/Azure Resources Management/Azure Backup Setup CheatSheet#131-example-notifiation-config","content":" "},{"title":"1.4. Configure Diagnostic log collection​","type":1,"pageTitle":"Azure Backup Setup CheatSheet","url":"/docs/Azure Resources Management/Azure Backup Setup CheatSheet#14-configure-diagnostic-log-collection","content":"Configure diagnostic logs to be sent from Azure Backup to the Log Anlytics workspace above. Navigate to Diagnostic settings under Monitoring.Click Add Diagnostic Settings.Name your diagnostic setting, something informational, for example, &quot;AzBkup-Diagnostics&quot;, suggestion, Backup Report Data.Select Send to Log Analytics Workspace.Add a workspace and don't touch any other settings.Hit Save. Make sure to run the initial backup job from the Azure Backup Dashboard. "},{"title":"What can you Automate","type":0,"sectionRef":"#","url":"/blog/What can you Automate","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. Joiner, Mover and Leaver Processes​","type":1,"pageTitle":"What can you Automate","url":"/blog/What can you Automate#1-joiner-mover-and-leaver-processes","content":"If you're or, have worked in a Service Desk role level 1 upwards, you'll be well aware of the pain that is administering user accounts. The amount of time spent correcting someone's first or last name is crazy! In my experience, we squashed a lot of the mistakes by automating the process as much as possible. I've done this using PowerShell and getting the Service Desk staff to submit the new starter or leaver data into the form. I'll upload this script to the Github repo, please note that the script is targeted at hybrid environments. "},{"title":"2. Certificate & Secret Management for Azure AD​","type":1,"pageTitle":"What can you Automate","url":"/blog/What can you Automate#2-certificate--secret-management-for-azure-ad","content":"Azure AD is a wonderful tool but, it can be super complex to manage and keep track of what's going on within it. One such task is making sure that none of the App Registrations has a soon-to-expire certificate or secret. The best solution to this is tracking your certs in some fashion however, whatever solution you chose to use, if someone adds a new App Registration then that may not be picked up. Link to a script created by Microsoft, here. "},{"title":"3. Reporting​","type":1,"pageTitle":"What can you Automate","url":"/blog/What can you Automate#3-reporting","content":"Something that has always come up is keeping an accurate asset inventory for Azure AD joined devices as well as all of the other types captured within Intune. Since Intune does not have its own PowerShell module (I think, I did find this however from Microsoft's Github!), you'd need to rely on one of the Microsoft portals for a report, which isn't too annoying to get in real terms. An automated method would be to create a script to connect to Azure AD, retrieve device information and dump this out into Excel for someone to review. You could host this in an Automation account in Azure to run automatically. "},{"title":"4. Patch Management​","type":1,"pageTitle":"What can you Automate","url":"/blog/What can you Automate#4-patch-management","content":"At the moment, you can patch your VM estate using an Automation account rather than relying on running your own WSUS server, of course, if you want to control the flow better in line with any on-prem infrastructure that'd be the way to go; I'd still suggest letting Microsoft patch them though, it's remarkably good and a great quality of life update for your engineers! On a side note, I believe Microsoft has just released Update management centre which is its own service in Azure to replace the Automation account method mentioned above. Learn more about Update Management Centre,here. "},{"title":"5. Configuration Management​","type":1,"pageTitle":"What can you Automate","url":"/blog/What can you Automate#5-configuration-management","content":"Automation of resource creation and also management is a great use of this technology. As I've mentioned previously, Bicep and PowerShell will let you do this, along with Terraform which works well with Azure. Other languages will let you do this but, I have only used the three mentioned above. Thanks for reading! "},{"title":"Restore from Snapshot","type":0,"sectionRef":"#","url":"/docs/Azure Resources Management/Restore from Snapshot","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. Before you begin​","type":1,"pageTitle":"Restore from Snapshot","url":"/docs/Azure Resources Management/Restore from Snapshot#1-before-you-begin","content":"Confirm snapshot data is valid. "},{"title":"2. Create your snapshot​","type":1,"pageTitle":"Restore from Snapshot","url":"/docs/Azure Resources Management/Restore from Snapshot#2-create-your-snapshot","content":"Navigate to a VM that is available to have a disk attached to it. Click Disks. Create new disk.  Click Edit on the far right hand side. As shown in red above. Name your Disk, I'd suggest, snapshot_ServerName_Date_Time Source, select snapshot.  Select the Snapshot you wish to attach.  Make any changes to the Encryption Type. I'd suggest it not to be a shared disk. Press Save.  This shouldn't take too long. If you see the error below, change the Host Caching optio n to &quot;none&quot;.  "},{"title":"3. Confirm disk is visibile in the OS​","type":1,"pageTitle":"Restore from Snapshot","url":"/docs/Azure Resources Management/Restore from Snapshot#3-confirm-disk-is-visibile-in-the-os","content":"The share should be available from the get go however, you may need to bring the disk online within computer management. RDP into your VM &amp; check File Explorer for your disk, the name will be what the share was called originally.Open Computer Management, Click Disk Management.Right-Click on the disk, mark it as Oneline.You should now see it in File Explorer. "},{"title":"4. Detach the disk​","type":1,"pageTitle":"Restore from Snapshot","url":"/docs/Azure Resources Management/Restore from Snapshot#4-detach-the-disk","content":"Close any open sessions to the disk that you attached.Navigate back to the VM in Azure Management Portal.Click the X button next to the disk. "},{"title":"Take ownership of customer azure subscription","type":0,"sectionRef":"#","url":"/docs/Microsoft Partner Centre/take ownership of customer azure subscription","content":"Take ownership of customer azure subscription Microsoft Article: Reinstate admin privileges for a customer's Azure CSP subscriptions. # Connect to Sub. Connect-AzAccount -TenantID &quot;&lt;Customer TenantID&gt;&quot; # Set the subscription context you want to add partner permissions too. Set-AzContext -SubscriptionID &quot;&lt;Customer Subscription ID&gt;&quot; # Assign the &quot;adminagents&quot; group in Partner tenant to the customer subscription New-AzRoleAssignment -ObjectID &quot;&lt;Object ID of the AdminAgents group from step 7 of your actions section&gt;&quot; -RoleDefinitionName &quot;Owner&quot; -Scope &quot;/subscriptions/&lt;CSP subscription ID&gt;&quot; -ObjectType &quot;ForeignGroup&quot; ","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"AutoPilot Reset","type":0,"sectionRef":"#","url":"/docs/Intune/AutoPilot Reset","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. Prerequisit Steps in Intune​","type":1,"pageTitle":"AutoPilot Reset","url":"/docs/Intune/AutoPilot Reset#1-prerequisit-steps-in-intune","content":"Logon to Microsoft Endpoint Manager admin centre: https://endpoint.microsoft.com/ "},{"title":"1.1. Confirm the device has the correct group tag​","type":1,"pageTitle":"AutoPilot Reset","url":"/docs/Intune/AutoPilot Reset#11-confirm-the-device-has-the-correct-group-tag","content":"Ignore this step if you know you do not use group tags. Sometimes group tags within Autopilot are used to assign device profiles\\policies after the device has been enrolled. This group tag must be correct otherwise it'll interfer with the reset. Click Devices &gt; Windows &gt; Windows Enrollment &gt; Devices.Find the Serial number of the device and search it here.Click on your device, alter group tag** here to the correct one.Click Save Wait for the profile status to change to assigned, this is automatic and can take 5 - 10 minutes. "},{"title":"2. Initiate the reset​","type":1,"pageTitle":"AutoPilot Reset","url":"/docs/Intune/AutoPilot Reset#2-initiate-the-reset","content":"The Windows device MUST have a stable internet connection to complete this process. Click Devices &gt; Windows &gt; Windows Devices, it should already be on this option.Search for your device and click on the device name.Click the Autopilot Reset option.Click Yes. Wait for the Windows device to reset, it must maintain internet connection throughout this process. "},{"title":"3. On the device​","type":1,"pageTitle":"AutoPilot Reset","url":"/docs/Intune/AutoPilot Reset#3-on-the-device","content":"Make sure the machine is powered on and connected to an internet source.The Autopilot process should start automatically.When the option appears, select Windows Autopilot provisioning. Autopilot should take over from here and reset the device.  Once completed you should then be returned to a login prompt.  "},{"title":"Sending Logs to Log Analytics","type":0,"sectionRef":"#","url":"/docs/Intune/Sending Logs to Log Analytics","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1.1. Logs that can be ingested​","type":1,"pageTitle":"Sending Logs to Log Analytics","url":"/docs/Intune/Sending Logs to Log Analytics#11-logs-that-can-be-ingested","content":"Microsoft Intune includes built-in logs that provide information about your environment: Audit Logs shows a record of activities that generate a change in Intune, including create, update (edit), delete, assign, and remote actions.Operational Logs show details on users and devices that successfully (or failed) to enroll, and details on non-compliant devices.Device Compliance Organizational Logs show an organizational report for device compliance in Intune, and details on non-compliant devices.IntuneDevices show device inventory and status information for Intune enrolled and managed devices. "},{"title":"1.2. Notes​","type":1,"pageTitle":"Sending Logs to Log Analytics","url":"/docs/Intune/Sending Logs to Log Analytics#12-notes","content":""},{"title":"1.2.1. Benefits​","type":1,"pageTitle":"Sending Logs to Log Analytics","url":"/docs/Intune/Sending Logs to Log Analytics#121-benefits","content":"The main benefit of using Log Analytics is the visualisation, monitoring, and alerting on the connected data.Archive the data to review at a later date.Stream the logs into Azure Event hub for review in other 3rd party tools. "},{"title":"1.2.2. Cons (Sort of)​","type":1,"pageTitle":"Sending Logs to Log Analytics","url":"/docs/Intune/Sending Logs to Log Analytics#122-cons-sort-of","content":"All of the above logs can be found within the Intune portal, login to EndPoint Manager (Intune) &gt; Devices &gt; Monitor. Audit Logs - login to EndPoint Manager (Intune) &gt; Devices &gt; Monitor &gt; Other &gt; Device actions.Operational Logs - login to EndPoint Manager (Intune) &gt; Devices &gt; Monitor &gt; Enrollment &gt; Enrollment Failures .and login to EndPoint Manager (Intune) &gt; Devices &gt; Monitor &gt; Compliance &gt; Noncompliant devices.Device Compliance Organizational Logs - login to EndPoint Manager (Intune) &gt; Reports &gt; Device compliance.IntuneDevices - login to EndPoint Manager (Intune) &gt; Devices &gt;All Devices. "},{"title":"Setup sending data​","type":1,"pageTitle":"Sending Logs to Log Analytics","url":"/docs/Intune/Sending Logs to Log Analytics#setup-sending-data","content":"Microsoft link to instructions to set this up. "},{"title":"Cost estimations and Dependancies​","type":1,"pageTitle":"Sending Logs to Log Analytics","url":"/docs/Intune/Sending Logs to Log Analytics#cost-estimations-and-dependancies","content":"Microsoft link - Storage size for activity logs. "},{"title":"Manging AD with PowerShell","type":0,"sectionRef":"#","url":"/docs/PowerShell/Manage Active Directory with PowerShell","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"Filter by an attribute​","type":1,"pageTitle":"Manging AD with PowerShell","url":"/docs/PowerShell/Manage Active Directory with PowerShell#filter-by-an-attribute","content":" # Filter mail address is like &amp; the user has to be enabled. Get-ADUser -Filter &quot;Mail -like '*@&lt;domain&gt;co.uk' -and enabled -eq '$true'&quot; | Select Name, UserPrincipalname # Fitler where user is disabled. Get-ADUser -Filter 'enabled -eq $false' | Select name, DistinguishedName  "},{"title":"Setup an Azure Subscription from Partner Centre","type":0,"sectionRef":"#","url":"/docs/Microsoft Partner Centre/Setup an Azure Subscription from Partner Centre","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1.1. Before you begin​","type":1,"pageTitle":"Setup an Azure Subscription from Partner Centre","url":"/docs/Microsoft Partner Centre/Setup an Azure Subscription from Partner Centre#11-before-you-begin","content":"Who'll manage this subscription? If it's being setup with the CSP in mind, it'll be the CSP. Who'll be supporting this subscription? Will it be added to BAU.What Groups and\\or accounts need to manage it, (Owner, Contributor, Reader). "},{"title":"1.2. Setup Process​","type":1,"pageTitle":"Setup an Azure Subscription from Partner Centre","url":"/docs/Microsoft Partner Centre/Setup an Azure Subscription from Partner Centre#12-setup-process","content":"Microsoft Link. Sign in to the Azure portal using your Partner Center account.Make sure you are in your Partner Center directory (tenant), not a customer’s tenant.Navigate to Cost Management + Billing.Select the Billing scope for your billing account where the customer account resides.In the left menu under Billing, select Customers.On the Customers page, select the customer. If you have only one customer, the selection is unavailable.In the left menu, under Products + services, select All billing subscriptions.On the Azure subscription page, select + Add to create a subscription.Then select the type of subscription to add. For example, Usage based/ Azure subscription.On the Basics tab, enter a subscription name.Select the partner's billing account.Select the partner's billing profile.Select the customer that you're creating the subscription for and, if applicable, select a reseller.Next to Plan, select Microsoft Azure Plan for DevTest, if the subscription will be used for development or testing workloads. Otherwise, select Microsoft Azure Plan.Optionally, select the Tags tab and then enter tag pairs for Name and Value.Select Review + create. You should see a message stating Validation passed.Verify that the subscription information is correct, then select Create. You'll see a notification that the subscription is getting created. The customer will see the new subscription appear for them within 60 minutes, they may need to amend the subscription filter to see the new sub. If the end user you're testing with is not in the root managemnt group, you'll need to grant them a role over the Subscription before they can see it. "},{"title":"Approve or Block an App","type":0,"sectionRef":"#","url":"/docs/Teams/Approve or Block an App","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. Steps to complete​","type":1,"pageTitle":"Approve or Block an App","url":"/docs/Teams/Approve or Block an App#1-steps-to-complete","content":"Login to Teams Admin Centre, https://admin.teams.microsoft.com/Click Teams Apps &gt; Manage apps.In the section towards the bottom of the page, search for the applicaton and select it.Click on Allow or Block in the action bar above the list. "},{"title":"What is Automation in Azure?","type":0,"sectionRef":"#","url":"/blog/What is Automation in Azure","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. What is Automation in Azure?​","type":1,"pageTitle":"What is Automation in Azure?","url":"/blog/What is Automation in Azure#1-what-is-automation-in-azure","content":"Automation is needed, almost required, in three general areas of cloud operations; Deployment and management of resources - To deliver a repeatable and consistent infrastructure. Response - Event-based automation can be used to diagnose and resolve issues within the on-prem and off-prem environments. Orchestrate - Orchestrate and integrate your automation with other Azure or third party services and products. Using any one of the three above can be a huge improvement to the working quality of life of the team and can save huge amounts of time if implemented well. Firstly you need to get your team on board with this approach, which can present its own challenge. "},{"title":"2. Pros and Cons of the Automation Approach​","type":1,"pageTitle":"What is Automation in Azure?","url":"/blog/What is Automation in Azure#2-pros-and-cons-of-the-automation-approach","content":"I may well be a little biased here but, in my experience, if the status quo is to prefer manual tasks. It will be hard going initially to get others to see the light that is automating away &quot;their&quot; jobs. I use quote marks there because, the typical Infrastructure role is changing rapidly. "},{"title":"2.1. Pros​","type":1,"pageTitle":"What is Automation in Azure?","url":"/blog/What is Automation in Azure#21-pros","content":"Reduce time to perform an action.Reduce risk in performing the action.Freeing up staff from the burden of manual tasks.Standardisation of tasks. "},{"title":"2.2. Cons​","type":1,"pageTitle":"What is Automation in Azure?","url":"/blog/What is Automation in Azure#22-cons","content":"Time consuming to implement in the first instance.Staff need training on the automation methods.You may encounter resistance when it comes to changing the status quo. "},{"title":"3. Tools at your disposal​","type":1,"pageTitle":"What is Automation in Azure?","url":"/blog/What is Automation in Azure#3-tools-at-your-disposal","content":"A very brief overview of the various tools that can be used, my first suggestion is to investigate the use of PowerShell and RunBooks; they've always seemed to make the most sense to start with. "},{"title":"3.1. PowerShell​","type":1,"pageTitle":"What is Automation in Azure?","url":"/blog/What is Automation in Azure#31-powershell","content":"This is an incredibly versatile tool that can be used to manage almost any resource on-prem and in the cloud. I'd suggest digging into the Azure CLI and also familiarising yourself with the Office 365 modules too (SharePoint Online, Exchange Online, Microsoft Teams, Azure Active Directory, more in-depth KBs and posts to follow on these. You aren't just restricted to using PowerShell from your machine running the Windows OS, you can also use an Automation Account with a PowerShell runbook, I'll upload a KB to get you started soon! Learn more about PowerShell here. "},{"title":"3.2. Azure Bicep​","type":1,"pageTitle":"What is Automation in Azure?","url":"/blog/What is Automation in Azure#32-azure-bicep","content":"Bicep is a declarative language, used to deploy Azure resources. In a Bicep file, you define what you want to deploy to Azure and then use that file to repeatedly deploy your infrastructure. It's a great tool to ensure consistency in your environments although, this is a separate language to learn and only applies to Azure. You can learn more about Bicep here. "},{"title":"3.3. Azure Logic Apps​","type":1,"pageTitle":"What is Automation in Azure?","url":"/blog/What is Automation in Azure#33-azure-logic-apps","content":"Logic Apps is a cloud platform\\service where you can create and run workflows in Azure (there's an Office 365 version with a cut-down toolset called Power Automate which is also really good). The major plus of using these is that they require little to no code at all to set up, it's all visual. Logic Apps integrate with most Office 365 and Azure services making them versatile, easy to maintain and accessible to people with less knowledge of coding. Learn more about Logic Apps here. Thanks for reading! I hope that gives you some idea of what options there are for automation in Azure, I'll be following up with another post of suggested processes you can automate both from suggestions online and from my experience. "},{"title":"Prettier Terminal Window","type":0,"sectionRef":"#","url":"/docs/PowerShell/Prettier Terminal Window","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"Install the Windows Terminal App​","type":1,"pageTitle":"Prettier Terminal Window","url":"/docs/PowerShell/Prettier Terminal Window#install-the-windows-terminal-app","content":"Download it free from the Microsoft store, once installed run the terminal application. If you're doing this on a domain joined machine, you'll need to run the terminal application on both the user account and the administrator account to create the profiles. "},{"title":"Install OH-MY-POSH​","type":1,"pageTitle":"Prettier Terminal Window","url":"/docs/PowerShell/Prettier Terminal Window#install-oh-my-posh","content":"Follow these instructions for Windows machines, this is the official website. I recommend using winget via PowerShell to get the stuff. winget install JanDeDobbeleer.OhMyPosh -s winget  "},{"title":"Download fonts from Nerd Fonts​","type":1,"pageTitle":"Prettier Terminal Window","url":"/docs/PowerShell/Prettier Terminal Window#download-fonts-from-nerd-fonts","content":"These are some instructions from the Oh My Posh site to do this. In your terminal prompt, type oh-my-posh font install, this should then install the on my posh font. Next you need to configure the Terminal app to use the new font. You can edit the JSON file or you can do it in the GUI by clicking on the down arrow next to your open tab in Terminal. Click Settings, then click Defaults and click Appearance. Click on the font list next to the option, Font Face, select the Oh my posh font. "},{"title":"Edit the PowerShell profile​","type":1,"pageTitle":"Prettier Terminal Window","url":"/docs/PowerShell/Prettier Terminal Window#edit-the-powershell-profile","content":"Check out this link for the source matierial for the below Edit your PowerShell profile script, you can find its location under the $PROFILE variable in your preferred PowerShell version. For example, using notepad, notepad $PROFILE. If the command errors, you will need to create the profiel first, New-Item -Path $PROFILE -Type File -Force. Inside your profile, add the following line into it. oh-my-posh init pwsh --config 'C:/Users/Posh/jandedobbeleer.omp.json' | Invoke-Expression  If you want to change the theme, navigate to the theme folder, if you don't know where that is, enter the following command (Get-Command oh-my-posh).Source. "},{"title":"Other suggestions​","type":1,"pageTitle":"Prettier Terminal Window","url":"/docs/PowerShell/Prettier Terminal Window#other-suggestions","content":""},{"title":"Install PSReadLine​","type":1,"pageTitle":"Prettier Terminal Window","url":"/docs/PowerShell/Prettier Terminal Window#install-psreadline","content":"This module shows autocomplete suggestions based on the recent commands you've run, it's a great addition. Reference blog post from the Microsoft DevBlogs. Install the module, Install-Module PSReadLine. You need version 2.1.0 or higher for this to work properly. Enable Predictive IntelliSense by running this command, Set-PSReadLineOption -PredictionSource History, you should then start to see grey text in your PowerShell prompt that's running currently. The default key binding to use the prediction is right-arrow. You can change the color for those predictions by using the following commands. Set-PSReadLineOption -Colors @{ InlinePrediction = '#8A0303'} # This is dark red. Set-PSReadLineOption -Colors @{ InlinePrediction = '#2F7004'} # This is a dark green. # This will set it back to default. Set-PSReadLineOption -Colors @{ InlinePrediction = &quot;$([char]0x1b)[36;7;238m&quot;}  Make sure to update your PowerShell profile to load this module. Type notepad $profile into your terminal window, this should load your profile into notepad. Paste in the following lines. Set-PSReadLineOption -PredictionSource History Set-PSReadLineOption -PredictionViewStyle ListView  "},{"title":"Restore Errors","type":0,"sectionRef":"#","url":"/docs/Veeam Backup for O365/Restore Errors","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"Failing to open mailbox​","type":1,"pageTitle":"Restore Errors","url":"/docs/Veeam Backup for O365/Restore Errors#failing-to-open-mailbox","content":""},{"title":"Scenario​","type":1,"pageTitle":"Restore Errors","url":"/docs/Veeam Backup for O365/Restore Errors#scenario","content":"Your Veeam Backup for Office 365 solution is pretty new and it's being tested or you've a member of your team who always gets this error for some reason. "},{"title":"The error​","type":1,"pageTitle":"Restore Errors","url":"/docs/Veeam Backup for O365/Restore Errors#the-error","content":"Failed to access mailbox. Mailbox does not exist. This issue mostly presents that error when you're using Modern Authentication. "},{"title":"Solution​","type":1,"pageTitle":"Restore Errors","url":"/docs/Veeam Backup for O365/Restore Errors#solution","content":"It turns out that in order to restore objects the user who authenticates to do the restore action must have the impersonation role, this is a custom role that you need to create via command line.  "},{"title":"Managing Backup Jobs","type":0,"sectionRef":"#","url":"/docs/Veeam Backup for O365/Managing Backup Jobs","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"Before you begin​","type":1,"pageTitle":"Managing Backup Jobs","url":"/docs/Veeam Backup for O365/Managing Backup Jobs#before-you-begin","content":"Veeam best practice guide link, here.Veeam User guide link, here. "},{"title":"Recommendations​","type":1,"pageTitle":"Managing Backup Jobs","url":"/docs/Veeam Backup for O365/Managing Backup Jobs#recommendations","content":""},{"title":"Split-up the jobs​","type":1,"pageTitle":"Managing Backup Jobs","url":"/docs/Veeam Backup for O365/Managing Backup Jobs#split-up-the-jobs","content":"This was a recommendation from the good folks at Veeam. Try to split the jobs based on size being backed up. An example of a suggestion below. Create a single job to capture anything that is new.If you've got loads of small SharePoint sites, split them into chunks as these will take a long time to backup. A few thousand of these will take hours to backup. For example, take the largest 10 sites and put them in their own jobs.The SharePoint backup job will also back personal sites as well, no need to include the personal sites in the other jobs. "},{"title":"Server resources & Backup App Registrations​","type":1,"pageTitle":"Managing Backup Jobs","url":"/docs/Veeam Backup for O365/Managing Backup Jobs#server-resources--backup-app-registrations","content":"Both resources (CPU &amp; RAM) play a major role in the performance of the proxy server. Make sure you don't go beneath 4vCPUs &amp; 16GB of RAM, below this and you'll start to see a noticable time incrase in backups.For the moment you can add more backup applications into Azure AD, that increases the amount of requests that can be made to the Office 365 resources. The more backup applications you have the quicker you'll exhaust the amount of requests that can be made per minute by the VBO solution to backup the data. "},{"title":"Microsoft Throttling​","type":1,"pageTitle":"Managing Backup Jobs","url":"/docs/Veeam Backup for O365/Managing Backup Jobs#microsoft-throttling","content":"After speaking with Microsoft, they no longer change the throttling limits upon request.You're limited due to the size of your organisation and amount of users, check out the link below for more information on throttling. Microsoft Link - Avoid getting throttled or blocked in SharePoint Online. "},{"title":"Object Management​","type":1,"pageTitle":"Managing Backup Jobs","url":"/docs/Veeam Backup for O365/Managing Backup Jobs#object-management","content":"Setup an Azure AD group to capture user objects that need to be excluded from the backups.Microsoft 365 Groups require an owner to be backed up, otherwise they'll generate warnings in your jobs. "},{"title":"Welcome to the Wiki","type":0,"sectionRef":"#","url":"/docs/Welcome to the Wiki","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"1. How to use the wiki​","type":1,"pageTitle":"Welcome to the Wiki","url":"/docs/Welcome to the Wiki#1-how-to-use-the-wiki","content":"Naviagte using the navbar on the left hand side.There is a search bar in the top right, try searching keywords for what you're after. "},{"title":"2. New docs this week​","type":1,"pageTitle":"Welcome to the Wiki","url":"/docs/Welcome to the Wiki#2-new-docs-this-week","content":""},{"title":"2.1. Azure Resource Management​","type":1,"pageTitle":"Welcome to the Wiki","url":"/docs/Welcome to the Wiki#21-azure-resource-management","content":"Assign Managed Identity permissions via CMDLine.Automation Account Setup Cheatsheet.Azure SQL Server setup Cheatsheet. "},{"title":"2.2. PowerShell​","type":1,"pageTitle":"Welcome to the Wiki","url":"/docs/Welcome to the Wiki#22-powershell","content":"Helpful Commands. "},{"title":"2.3. Microsoft Partner Centre​","type":1,"pageTitle":"Welcome to the Wiki","url":"/docs/Welcome to the Wiki#23-microsoft-partner-centre","content":"Setup an Azure Subscription from Partner Centre. "},{"title":"2.4. Veeam Backup for Office 365​","type":1,"pageTitle":"Welcome to the Wiki","url":"/docs/Welcome to the Wiki#24-veeam-backup-for-office-365","content":"Restore Errors. "},{"title":"Removing data and licenses","type":0,"sectionRef":"#","url":"/docs/Veeam Backup for O365/Removing data and licenses","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"References​","type":1,"pageTitle":"Removing data and licenses","url":"/docs/Veeam Backup for O365/Removing data and licenses#references","content":"Veeam Blog post - How to remove a license from a user in Veeam Backup for Microsoft Office 365. Veeam Rest API Reference - Revoking Licenses from users. "},{"title":"Overview​","type":1,"pageTitle":"Removing data and licenses","url":"/docs/Veeam Backup for O365/Removing data and licenses#overview","content":"To remove a license from a user, you first need to delete that user’s data from all configured repositories and run the remove license command with PowerShell. This can be useful if you accidently backed up a user and no longer need to keep the data. Otherwise, you must wait the 31-day threshold for the license to be reallocated. "},{"title":"Checking for stored data​","type":1,"pageTitle":"Removing data and licenses","url":"/docs/Veeam Backup for O365/Removing data and licenses#checking-for-stored-data","content":"Firstly, you'll need to check if there is any data stored for the user you want to remove the licnese from. Open the Veeam Backup console on your application host, select the hamburger menu in the top left, navigate to Console and click on PowerShell. # This script will show you what a data a user has on a particular repository # Fill in &quot;REPOSITORY&quot; with the name of the repository as it is showing in # Veeam Backup for Office 365 and the email address of the user you wish to remove the data for &quot;USER@DOMAIN.com&quot; $repository = Get-VBORepository -Name &quot;REPOSITORY&quot; $user = Get-VBOEntityData -Type User -Repository $repository -Name &quot;USER@DOMAIN.com&quot; $user  Provided the command above runs successfully, you'll get a table returned showing the repositories as headings, with True or False under them depending on whether the user has data in them. "},{"title":"Delete the user data from each repo​","type":1,"pageTitle":"Removing data and licenses","url":"/docs/Veeam Backup for O365/Removing data and licenses#delete-the-user-data-from-each-repo","content":"I won't regurgitate the perfectly good Veeam article, the link is below for all of the commands needed. How to remove a license from a user in Veeam Backup for Microsoft Office 365. Make sure to follow each section in the rough order of the article, skip over the ones where your user has no data. "},{"title":"Issues​","type":1,"pageTitle":"Removing data and licenses","url":"/docs/Veeam Backup for O365/Removing data and licenses#issues","content":"I ended up having to raise a support request in the end as I had some troublesome admin users who'd had their data backed up in error. I was asked by the support team member who helped me to not store the script that was used. "},{"title":"Commands returning \"Null\"​","type":1,"pageTitle":"Removing data and licenses","url":"/docs/Veeam Backup for O365/Removing data and licenses#commands-returning-null","content":"Some of the commands above for some reason will return a “null” error when using them, you will need to pipe the command into a search to find the relevant data. Get-VBOLicensedUser -Organization $org | ?{$_.username -like &quot;*-adm*&quot;} # You can then loop through an array if you store the above command into a variable. Get-VBOLicensedUser -Organization $org |?{$_.username -like &quot;*-adm*&quot;}|foreach-object {remove-vbolicenseduser $_}  "},{"title":"Helpful Commands","type":0,"sectionRef":"#","url":"/docs/PowerShell/Helpful Commands","content":"","keywords":"IT  blog  Microsoft  Azure  Computers"},{"title":"Get-Help​","type":1,"pageTitle":"Helpful Commands","url":"/docs/PowerShell/Helpful Commands#get-help","content":"Useful for finding out the command syntax and what switches are available for the command. Syntax // base command get-help // Getting help with a command get-help &lt;command name&gt; // Example Get-Help rename-item // Output to the above NAME Rename-Item SYNTAX Rename-Item [-Path] &lt;string&gt; [-NewName] &lt;string&gt; [-Force] [-PassThru] [-Credential &lt;pscredential&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;] Rename-Item [-NewName] &lt;string&gt; -LiteralPath &lt;string&gt; [-Force] [-PassThru] [-Credential &lt;pscredential&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;] ALIASES rni ren REMARKS Get-Help cannot find the Help files for this cmdlet on this computer. It is displaying only partial help. -- To download and install Help files for the module that includes this cmdlet, use Update-Help. -- To view the Help topic for this cmdlet online, type: &quot;Get-Help Rename-Item -Online&quot; or go to https://go.microsoft.com/fwlink/?LinkID=2097153.  "},{"title":"Get-Command​","type":1,"pageTitle":"Helpful Commands","url":"/docs/PowerShell/Helpful Commands#get-command","content":"Useful for finding out what commands are available to use for any modules you have installed. Syntax // Base command - will return thousands of results. Get-Command // Searching commands based on name, the wild cards allow searching for the keyword in any part of the name. Get-Command -Name *keyword* // Output for the above. CommandType Name Version Source ----------- ---- ------- ------ Function Rename-DAEntryPointTableItem 1.0.0.0 DirectAccessClientComponents Function Rename-MaskingSet 2.0.0.0 Storage Function Rename-MgCommunicationCallScreenSharingRole 1.10.0 Microsoft.Graph.CloudCommunications Function Rename-MgDeviceManagementVirtualEndpointCloudPc 1.10.0 Microsoft.Graph.DeviceManagement.Actions Function Rename-MgDeviceManagementVirtualEndpointCloudPcUs… 1.10.0 Microsoft.Graph.DeviceManagement.Actions Function Rename-MgUserCloudPc 1.10.0 Microsoft.Graph.Users.Actions Function Rename-MgUserCloudPcUserAccountType 1.10.0 Microsoft.Graph.Users.Actions Function Rename-NetAdapter 2.0.0.0 NetAdapter Function Rename-NetFirewallHyperVRule 2.0.0.0 NetSecurity Function Rename-NetFirewallRule 2.0.0.0 NetSecurity Function Rename-NetIPHttpsConfiguration 1.0.0.0 NetworkTransition Function Rename-NetIPsecMainModeCryptoSet 2.0.0.0 NetSecurity Function Rename-NetIPsecMainModeRule 2.0.0.0 NetSecurity Function Rename-NetIPsecPhase1AuthSet 2.0.0.0 NetSecurity Function Rename-NetIPsecPhase2AuthSet 2.0.0.0 NetSecurity Function Rename-NetIPsecQuickModeCryptoSet 2.0.0.0 NetSecurity Function Rename-NetIPsecRule 2.0.0.0 NetSecurity Function Rename-NetLbfoTeam 2.0.0.0 NetLbfo Function Rename-NetSwitchTeam 1.0.0.0 NetSwitchTeam Function Rename-Printer 1.1 PrintManagement Function Test-AzAppConfigurationStoreNameAvailability 1.2.0 Az.AppConfiguration Cmdlet Rename-AzContext 2.10.1 Az.Accounts Cmdlet Rename-Computer 7.0.0.0 Microsoft.PowerShell.Management Cmdlet Rename-Item 7.0.0.0 Microsoft.PowerShell.Management Cmdlet Rename-ItemProperty 7.0.0.0 Microsoft.PowerShell.Management Cmdlet Rename-LocalGroup 1.0.0.0 Microsoft.PowerShell.LocalAccounts Cmdlet Rename-LocalUser 1.0.0.0 Microsoft.PowerShell.LocalAccounts  "},{"title":"Export AAD Secrets and Certs","type":0,"sectionRef":"#","url":"/docs/PowerShell/Export AAD Secrets and Certs","content":"Export AAD Secrets and Certs The script below was created originally by Microsoft, I will find the link where this came from. ################################################################################# #DISCLAIMER: This is not an official PowerShell Script. We designed it specifically for the situation you have encountered right now. #Please do not modify or change any preset parameters. #Please note that we will not be able to support the script if it is changed or altered in any way or used in a different situation for other means. #This code-sample is provided &quot;AS IT IS&quot; without warranty of any kind, either expressed or implied, including but not limited to the implied warranties of merchantability and/or fitness for a particular purpose. #This sample is not supported under any Microsoft standard support program or service.. #Microsoft further disclaims all implied warranties including, without limitation, any implied warranties of merchantability or of fitness for a particular purpose. #The entire risk arising out of the use or performance of the sample and documentation remains with you. #In no event shall Microsoft, its authors, or anyone else involved in the creation, production, or delivery of the script be liable for any damages whatsoever (including, without limitation, damages for loss of business profits, business interruption, loss of business information, or other pecuniary loss) arising out of the use of or inability to use the sample or documentation, even if Microsoft has been advised of the possibility of such damages. ################################################################################# Connect-AzureAD $Applications = Get-AzureADApplication -all $true $Logs = @() foreach ($app in $Applications) { $AppName = $app.DisplayName $AppID = $app.objectid $ApplID = $app.AppId $AppCreds = Get-AzureADApplication -ObjectId $AppID | Select-Object PasswordCredentials, KeyCredentials $secret = $AppCreds.PasswordCredentials $cert = $AppCreds.KeyCredentials ############################################ $Log = New-Object System.Object $Log | Add-Member -MemberType NoteProperty -Name &quot;ApplicationName&quot; -Value $AppName $Log | Add-Member -MemberType NoteProperty -Name &quot;ApplicationID&quot; -Value $ApplID $Log | Add-Member -MemberType NoteProperty -Name &quot;Secret Start Date&quot; -Value $Null $Log | Add-Member -MemberType NoteProperty -Name &quot;Secret End Date&quot; -value $Null $Log | Add-Member -MemberType NoteProperty -Name &quot;Certificate Start Date&quot; -Value $Null $Log | Add-Member -MemberType NoteProperty -Name &quot;Certificate End Date&quot; -value $Null $Log | Add-Member -MemberType NoteProperty -Name &quot;Owner&quot; -Value $Null $Log | Add-Member -MemberType NoteProperty -Name &quot;Owner_ObjectID&quot; -value $Null $Logs += $Log ############################################ foreach ($s in $secret) { $StartDate = $s.StartDate $EndDate = $s.EndDate #$operation = $EndDate - $now #$ODays = $operation.Days $Owner = Get-AzureADApplicationOwner -ObjectId $app.ObjectId $Username = $Owner.UserPrincipalName -join &quot;;&quot; $OwnerID = $Owner.ObjectID -join &quot;;&quot; if ($owner.UserPrincipalName -eq $Null) { $Username = $Owner.DisplayName + &quot; **&lt;This is an Application&gt;**&quot; } if ($Owner.DisplayName -eq $null) { $Username = &quot;&lt;&lt;No Owner&gt;&gt;&quot; } $Log = New-Object System.Object $Log | Add-Member -MemberType NoteProperty -Name &quot;ApplicationName&quot; -Value $AppName $Log | Add-Member -MemberType NoteProperty -Name &quot;ApplicationID&quot; -Value $ApplID $Log | Add-Member -MemberType NoteProperty -Name &quot;Secret Start Date&quot; -Value $StartDate $Log | Add-Member -MemberType NoteProperty -Name &quot;Secret End Date&quot; -value $EndDate $Log | Add-Member -MemberType NoteProperty -Name &quot;Certificate Start Date&quot; -Value $Null $Log | Add-Member -MemberType NoteProperty -Name &quot;Certificate End Date&quot; -value $Null $Log | Add-Member -MemberType NoteProperty -Name &quot;Owner&quot; -Value $Username $Log | Add-Member -MemberType NoteProperty -Name &quot;Owner_ObjectID&quot; -value $OwnerID $Logs += $Log } foreach ($c in $cert) { $CStartDate = $c.StartDate $CEndDate = $c.EndDate #$COperation = $CEndDate - $now #$CODays = $COperation.Days $Owner = Get-AzureADApplicationOwner -ObjectId $app.ObjectId $Username = $Owner.UserPrincipalName -join &quot;;&quot; $OwnerID = $Owner.ObjectID -join &quot;;&quot; if ($owner.UserPrincipalName -eq $Null) { $Username = $Owner.DisplayName + &quot; **&lt;This is an Application&gt;**&quot; } if ($Owner.DisplayName -eq $null) { $Username = &quot;&lt;&lt;No Owner&gt;&gt;&quot; } $Log = New-Object System.Object $Log | Add-Member -MemberType NoteProperty -Name &quot;ApplicationName&quot; -Value $AppName $Log | Add-Member -MemberType NoteProperty -Name &quot;ApplicationID&quot; -Value $ApplID $Log | Add-Member -MemberType NoteProperty -Name &quot;Certificate Start Date&quot; -Value $CStartDate $Log | Add-Member -MemberType NoteProperty -Name &quot;Certificate End Date&quot; -value $CEndDate $Log | Add-Member -MemberType NoteProperty -Name &quot;Owner&quot; -Value $Username $Log | Add-Member -MemberType NoteProperty -Name &quot;Owner_ObjectID&quot; -value $OwnerID $Logs += $Log } } Write-host &quot;Add the Path you'd like us to export the CSV file to, in the format of &lt;C:\\Users\\&lt;USER&gt;\\Desktop\\Users.csv&gt;&quot; -ForegroundColor Green $Path = Read-Host $Logs | Export-CSV $Path -NoTypeInformation -Encoding UTF8 ","keywords":"IT  blog  Microsoft  Azure  Computers"}]
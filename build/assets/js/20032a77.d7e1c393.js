"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2153],{3905:(e,t,r)=>{r.d(t,{Zo:()=>s,kt:()=>d});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var u=n.createContext({}),c=function(e){var t=n.useContext(u),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},s=function(e){var t=c(e.components);return n.createElement(u.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,i=e.originalType,u=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),p=c(r),g=o,d=p["".concat(u,".").concat(g)]||p[g]||m[g]||i;return r?n.createElement(d,a(a({ref:t},s),{},{components:r})):n.createElement(d,a({ref:t},s))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=r.length,a=new Array(i);a[0]=g;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l[p]="string"==typeof e?e:o,a[1]=l;for(var c=2;c<i;c++)a[c]=r[c];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}g.displayName="MDXCreateElement"},1721:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var n=r(7462),o=(r(7294),r(3905));const i={sidebar_position:4,id:"Azure Backup Setup CheatSheet",title:"Azure Backup Setup CheatSheet",tags:["Azure"]},a=void 0,l={unversionedId:"Azure Resources Management/Azure Backup Setup CheatSheet",id:"Azure Resources Management/Azure Backup Setup CheatSheet",title:"Azure Backup Setup CheatSheet",description:"1.1. Create the below resources in the FW-Azure Production subscription",source:"@site/docs/Azure Resources Management/Azure Backup Setup CheatSheet.md",sourceDirName:"Azure Resources Management",slug:"/Azure Resources Management/Azure Backup Setup CheatSheet",permalink:"/docs/Azure Resources Management/Azure Backup Setup CheatSheet",draft:!1,tags:[{label:"Azure",permalink:"/docs/tags/azure"}],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,id:"Azure Backup Setup CheatSheet",title:"Azure Backup Setup CheatSheet",tags:["Azure"]},sidebar:"tutorialSidebar",previous:{title:"Restore from Snapshot",permalink:"/docs/Azure Resources Management/Restore from Snapshot"},next:{title:"Automation Account Setup Cheatsheet",permalink:"/docs/Azure Resources Management/Automation Account Setup Cheatsheet"}},u={},c=[{value:"1.1. Create the below resources in the FW-Azure Production subscription",id:"11-create-the-below-resources-in-the-fw-azure-production-subscription",level:2},{value:"1.2. Configure Backup Policy",id:"12-configure-backup-policy",level:2},{value:"1.3. Configure Alerting",id:"13-configure-alerting",level:2},{value:"1.3.1. Example notifiation config",id:"131-example-notifiation-config",level:3},{value:"1.4. Configure Diagnostic log collection",id:"14-configure-diagnostic-log-collection",level:2}],s={toc:c};function p(e){let{components:t,...i}=e;return(0,o.kt)("wrapper",(0,n.Z)({},s,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"11-create-the-below-resources-in-the-fw-azure-production-subscription"},"1.1. Create the below resources in the FW-Azure Production subscription"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Create the resource group, example, ",(0,o.kt)("inlineCode",{parentName:"li"},"rg-<customername>-<region>-<prod/dev>-backups-01"),"."),(0,o.kt)("li",{parentName:"ol"},"Create a recovery services vault to store the backups (GRS is the preferred option, LRS for lowest cost), example, ",(0,o.kt)("inlineCode",{parentName:"li"},"rsv-<customername>-<region>-<prod/dev>-backup-01"),"."),(0,o.kt)("li",{parentName:"ol"},"Create a log analytics workspace or reuse another one, example, ",(0,o.kt)("inlineCode",{parentName:"li"},"la-<customername>-<region>-<prod/dev>-backup-01"),".")),(0,o.kt)("h2",{id:"12-configure-backup-policy"},"1.2. Configure Backup Policy"),(0,o.kt)("p",null,"Configure the backup policy in-line with the SC team standard being used for other customers, this has been provided to me."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Suggested Name format: ",(0,o.kt)("inlineCode",{parentName:"li"},"Bkup-policy-<time of day>-<policy type>"),"."),(0,o.kt)("li",{parentName:"ul"},"Example name: ",(0,o.kt)("inlineCode",{parentName:"li"},"bkup-policy-nightly-std"),".")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Backup Policy Example",src:r(8431).Z,width:"872",height:"1024"})),(0,o.kt)("h2",{id:"13-configure-alerting"},"1.3. Configure Alerting"),(0,o.kt)("p",null,"Note that this method is using the old backup alerting method, this is being replaced by Azure Monitor."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/backup/backup-azure-monitoring-built-in-monitor?tabs=recovery-services-vaults#turning-on-azure-monitor-alerts-for-job-failure-scenarios"},"Microsoft Link for more information")),(0,o.kt)("p",null,"Configure diagnostic logs to be sent from Azure Backup to the Log Anlytics workspace above."),(0,o.kt)("p",null,"From the Recovery services vault just setup. Click on Backup Alerts, under the Monitoring section.Click Configure Notifications."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Enable Notifications: Yes"),(0,o.kt)("li",{parentName:"ul"},"Recipients(Email): ",(0,o.kt)("a",{parentName:"li",href:"mailto:monitoring@DomainName.com"},"monitoring@DomainName.com")),(0,o.kt)("li",{parentName:"ul"},"Notify: Hourly digest"),(0,o.kt)("li",{parentName:"ul"},"Severity: Critical & Warning")),(0,o.kt)("h3",{id:"131-example-notifiation-config"},"1.3.1. Example notifiation config"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Example notification config",src:r(4620).Z,width:"604",height:"646"})),(0,o.kt)("h2",{id:"14-configure-diagnostic-log-collection"},"1.4. Configure Diagnostic log collection"),(0,o.kt)("p",null,"Configure diagnostic logs to be sent from Azure Backup to the Log Anlytics workspace above."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Navigate to Diagnostic settings under Monitoring."),(0,o.kt)("li",{parentName:"ol"},"Click Add Diagnostic Settings."),(0,o.kt)("li",{parentName:"ol"},'Name your diagnostic setting, something informational, for example, "AzBkup-Diagnostics", suggestion, ',(0,o.kt)("inlineCode",{parentName:"li"},"Backup Report Data"),"."),(0,o.kt)("li",{parentName:"ol"},"Select Send to Log Analytics Workspace."),(0,o.kt)("li",{parentName:"ol"},"Add a workspace and don't touch any other settings."),(0,o.kt)("li",{parentName:"ol"},"Hit Save.")),(0,o.kt)("p",null,"Make sure to run the initial backup job from the Azure Backup Dashboard."))}p.isMDXComponent=!0},8431:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/AZ-Bkup-Policy-Create-01-573564d007987e2acee2ee797fcdec42.png"},4620:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/AZ-Bkup-exmpl-Notification-policy-01-5fbb19bcb18c94ca47a00adfddbc6965.png"}}]);